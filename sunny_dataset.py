# -*- coding: utf-8 -*-
"""sunny_dataset.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Ps8JPX8OwQqo0NTsEXP46n5s0DeN7GMV
"""

class SunnyDataset(Dataset):
  def __init__(self,images,masks,transforms=None):
    self.images = images
    self.masks = masks
    self.transforms = transforms
  def __len__(self): return len(self.images)
  def __getitem__(self, idx):
    image,mask = self.images[idx],self.masks[idx]
    if self.transforms:
      augmented = self.transforms(image=image, mask=mask)
      image = augmented['image']
      mask = augmented['mask']
    image = np.transpose(image,(2,0,1)).astype(np.float32)
    mask  = np.transpose(mask,(2,0,1)).astype(np.float32)
    image = torch.Tensor(image)/255.0
    mask  = torch.Tensor(mask)
    return image,mask